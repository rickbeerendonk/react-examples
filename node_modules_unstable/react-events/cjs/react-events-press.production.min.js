/** @license React vundefined
 * react-events-press.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */

'use strict';var r=require("react"),t="undefined"!==typeof window&&null!=window.navigator?/^Mac/.test(window.navigator.platform):!1,u={bottom:20,top:20,left:20,right:20},v=["keydown_active","pointerdown_active","click_active"],w="click keyup pointerup pointermove scroll pointercancel mouseup_active touchend".split(" ");"undefined"!==typeof window&&void 0===window.PointerEvent&&(v.push("touchstart","mousedown"),w.push("mousemove","touchmove","touchcancel","dragstart"));
function x(b){return"function"===typeof b}
function y(b,c,d,a,e,k){var h=a.pressTarget,f=a.pointerType,g=a.touchEvent;a=null!=b&&!0===b.nativeEvent.defaultPrevented||"press"===e&&a.shouldPreventClick;var q=d.getTimeStamp(),n="primary",l=null,p=null,m=null,A=null,B=null,C=null,D=!1,E=!1,F=!1,G=!1;if(b){b=b.nativeEvent;D=b.altKey;E=b.ctrlKey;F=b.metaKey;G=b.shiftKey;if(g=g||b)l=g.clientX,p=g.clientY,m=g.pageX,A=g.pageY,B=g.screenX,C=g.screenY;1===b.button&&(n="auxillary")}d.dispatchEvent({button:n,defaultPrevented:a,target:h,type:e,pointerType:f,
timeStamp:q,clientX:l,clientY:p,pageX:m,pageY:A,screenX:B,screenY:C,x:l,y:p,altKey:D,ctrlKey:E,metaKey:F,shiftKey:G},c,k)}function z(b,c,d,a){a.isPressed=!0;if(!a.isActivePressStart){a.isActivePressStart=!0;var e=b.nativeEvent,k=a.touchEvent||e;e=k.clientX;var h=k.clientY;k=a.isActivePressed;a.isActivePressed=!0;void 0!==e&&void 0!==h&&(a.activationPosition={x:e,y:h});e=d.onPressStart;x(e)&&y(b,e,c,a,"pressstart",0);k||(b=d.onPressChange,x(b)&&c.dispatchEvent(a.isActivePressed,b,0))}}
function H(b,c,d,a){a.isActivePressStart=!1;a.isPressed=!1;if(a.isActivePressed){a.isActivePressed=!1;var e=d.onPressEnd;x(e)&&y(b,e,c,a,"pressend",0);b=d.onPressChange;x(b)&&c.dispatchEvent(a.isActivePressed,b,0)}a.responderRegionOnDeactivation=null}function I(b){var c=b.key,d=b.target;b=d.tagName;d=d.isContentEditable;return("Enter"===c||" "===c||"Spacebar"===c)&&"INPUT"!==b&&"TEXTAREA"!==b&&!0!==d}
function J(b,c,d){b=b.objectAssign({},u,d.pressRetentionOffset);var a=c.getBoundingClientRect();c=a.left;d=a.right;var e=a.bottom;a=a.top;b&&(null!=b.bottom&&(e+=b.bottom),null!=b.left&&(c-=b.left),null!=b.right&&(d+=b.right),null!=b.top&&(a-=b.top));return{bottom:e,top:a,left:c,right:d}}function K(b,c){c.addedRootEvents&&(c.addedRootEvents=!1,b.removeRootEventTypes(w))}function L(b,c){b=b.changedTouches;for(var d=0;d<b.length;d++){var a=b[d];if(a.identifier===c)return a}return null}
function M(b,c,d,a){null==a.responderRegionOnDeactivation&&(a.responderRegionOnDeactivation=J(c,a.pressTarget,d));c=a.responderRegionOnActivation;d=a.responderRegionOnDeactivation;if(null!=c){var e=c.left;var k=c.top;var h=c.right;var f=c.bottom;null!=d&&(e=Math.min(e,d.left),k=Math.min(k,d.top),h=Math.max(h,d.right),f=Math.max(f,d.bottom))}c=b.clientX;b=b.clientY;a.isPressWithinResponderRegion=null!=e&&null!=h&&null!=k&&null!=f&&null!==c&&null!==b&&c>=e&&c<=h&&b>=k&&b<=f}
var N=r.unstable_createResponder("Press",{targetEventTypes:v,getInitialState:function(){return{activationPosition:null,addedRootEvents:!1,isActivePressed:!1,isActivePressStart:!1,isPressed:!1,isPressWithinResponderRegion:!0,pointerType:"",pressTarget:null,responderRegionOnActivation:null,responderRegionOnDeactivation:null,ignoreEmulatedMouseEvents:!1,activePointerId:null,shouldPreventClick:!1,touchEvent:null}},onEvent:function(b,c,d,a){var e=b.pointerId,k=b.pointerType,h=b.type;if(d.disabled)K(c,
a),H(b,c,d,a),a.ignoreEmulatedMouseEvents=!1;else{var f=b.nativeEvent,g=a.isPressed;!0===d.stopPropagation&&f.stopPropagation();switch(h){case "pointerdown":case "keydown":case "mousedown":case "touchstart":if(g)I(f)&&" "===f.key&&f.preventDefault();else{var q="touchstart"===h,n="pointerdown"===h,l="keyboard"===k;g="mouse"===k;if("mousedown"!==h||!a.ignoreEmulatedMouseEvents){a.shouldPreventClick=!1;if(n||q)a.ignoreEmulatedMouseEvents=!0;else if(l)if(I(f)){h=f.altKey;l=f.ctrlKey;var p=f.metaKey,m=
f.shiftKey;" "===f.key?f.preventDefault():!1===d.preventDefault||m||p||l||h||(a.shouldPreventClick=!0)}else break;a.pointerType=k;k=a.pressTarget=b.responderTarget;if(n)a.activePointerId=e;else if(q){e=f.targetTouches;e=0<e.length?e[0]:null;if(null===e)break;a.touchEvent=e;a.activePointerId=e.identifier}1<f.button||t&&g&&f.ctrlKey||(null!==k&&9!==k.nodeType&&(a.responderRegionOnActivation=J(c,k,d)),a.responderRegionOnDeactivation=null,a.isPressWithinResponderRegion=!0,z(b,c,d,a),a.addedRootEvents||
(a.addedRootEvents=!0,c.addRootEventTypes(w)))}}break;case "click":a.shouldPreventClick&&f.preventDefault()}}},onRootEvent:function(b,c,d,a){var e=b.pointerId,k=b.pointerType,h=b.target,f=b.type,g=b.nativeEvent,q=a.isPressed,n=a.activePointerId,l=a.pointerType;!0===d.stopPropagation&&g.stopPropagation();switch(f){case "pointermove":case "mousemove":case "touchmove":if(l!==k)break;if("pointermove"===f&&n!==e)break;else if("touchmove"===f){var p=L(g,n);if(null===p)break;a.touchEvent=p}var m=a.pressTarget;
null!==m&&null!==m&&9!==m.nodeType&&("mouse"===k&&c.isTargetWithinNode(h,m)?a.isPressWithinResponderRegion=!0:M(p||g,c,d,a));a.isPressWithinResponderRegion?q?(d=d.onPressMove,x(d)&&y(b,d,c,a,"pressmove",1)):z(b,c,d,a):H(b,c,d,a);break;case "pointerup":case "keyup":case "mouseup":case "touchend":if(q){if(q=g.button,p=!1,"pointerup"!==f||n===e){if("touchend"===f){m=L(g,n);if(null===m)break;h=a.touchEvent=m;h=c.getActiveDocument().elementFromPoint(h.clientX,h.clientY)}else if("keyup"===f){if(!I(g))break;
p=!0;K(c,a)}else 1===q&&K(c,a);c.isTargetWithinResponder(h)&&c.isTargetWithinHostComponent(h,"a")&&(e=g.altKey,f=g.ctrlKey,n=g.metaKey,l=g.shiftKey,!1===d.preventDefault||l||n||f||e||(a.shouldPreventClick=!0));e=a.pressTarget;H(b,c,d,a);f=d.onPress;null!==e&&x(f)&&(p||null===e||null===e||9===e.nodeType||("mouse"===k&&c.isTargetWithinNode(h,e)?a.isPressWithinResponderRegion=!0:M(m||g,c,d,a)),a.isPressWithinResponderRegion&&1!==q&&y(b,f,c,a,"press",0));a.touchEvent=null}}else"mouseup"===f&&(a.ignoreEmulatedMouseEvents=
!1);break;case "click":"keyboard"!==l&&K(c,a);break;case "scroll":if("mouse"===l)break;k=a.pressTarget;g=g.target;h=c.getActiveDocument();null===k||g!==h&&!c.isTargetWithinNode(k,g)||(a.touchEvent=null,a.isPressed&&(a.ignoreEmulatedMouseEvents=!1,H(b,c,d,a)),K(c,a));break;case "pointercancel":case "touchcancel":case "dragstart":a.touchEvent=null,a.isPressed&&(a.ignoreEmulatedMouseEvents=!1,H(b,c,d,a)),K(c,a)}},onUnmount:function(b,c,d){d.isPressed&&(K(b,d),H(null,b,c,d))},onOwnershipChange:function(b,
c,d){d.isPressed&&(K(b,d),H(null,b,c,d))}});module.exports={PressResponder:N,usePressResponder:function(b){return r.unstable_useResponder(N,b)}};
